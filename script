killall gpg-agent
rm -rf /etc/pacman.d/gnupg/
pacman-key --init
pacman-key --populate
pacman -Sy archlinux-keyring --noconfirm
pacman -S vim base-devel grub reflector networkmanager fuse git xdg-utils xdg-user-dirs --noconfirm
systemctl enable NetworkManager
reflector --country Czechia --save /etc/pacman.d/mirrorlist
ln -sf /usr/share/zoneinfo/Europe/Warsaw /etc/localtime
hwclock --systohc
sed -i '/pl_PL.UTF-8/s/^#//g' /etc/locale.gen
locale-gen
echo "KEYMAP=pl" > /etc/vconsole.conf
echo "LANG=pl_PL.UTF-8" > /etc/locale.conf
read -p "Podaj nazwe komputera: " hostname
echo "$hostname" > /etc/hostname
mkinitcpio -P
read -p "Podaj nazwe uzytkownika: " username
useradd -m $username
passwd $username
usermod -aG wheel $username
sed -i '/%wheel ALL=(ALL:ALL) ALL/s/^#//g' /etc/sudoers
typ=(parted /dev/sda print | grep -i Partition\ Table)
if ["$typ" == "msdos" ]
then
pacman -S grub --noconfirm
read -p "Podaj sciezke dysku na ktorym powinien zostac zainstalowany GRUB: " grubdir
grub-install --target=i386-pc "$grubdir"
grub-mkconfig -o /boot/grub/grub.cfg
break
elif [ "$typ" == "gpt" ]
then
pacman -S grub efibootmgr --noconfirm
read -p "Podaj sciezke partycji EFI: " efidir
mount --mkdir "$efidir" /boot/efi
grub-install --target=x86_64-efi --efi-directory=/boot/efi --bootloader-id=archlinux
grub-mkconfig -o /boot/grub/grub.cfg
break
else
echo "Niepoprawne partycjonowanie, przerywam skrypt..."
exit
fi
PS3="Ktory serwer audio powinien zostac zainstalowany?: "
options=("Pipewire" "Pulseaudio")
select opt in "${options[@]}"
do
    case $opt in
        "Pipewire")
    pacman -S pipewire pipewire-pulse pipewire-alsa pipewire-jack wireplumber pavucontrol --noconfirm
    systemctl enable --global pipewire
    systemctl enable --global pipewire-pulse
    break
    ;;
        "Pulseaudio")
    pacman -S pulseaudio pulseaudio-alsa pulseaudio-jack pulseaudio-bluetooth pulseaudio-zeroconf pulseaudio-lirc pavucontrol --noconfirm
    systemctl enable --global pulseaudio
    break
    ;;    
        *)
    echo "Nieprawidlowa opcja"
    ;;
esac
done
PS3="Ktore srodowisko graficzne powinno zostac zainstalowane?: "
options=("KDE Plasma" "XFCE" "MATE" "Cinnamon" "GNOME")
select opt in "${options[@]}"
do
    case $opt in
        "KDE Plasma")
    pacman -S plasma sddm gwenview kate pipewire pipewire-pulse pipewire-alsa pipewire-jack wireplumber noto-fonts noto-fonts-emoji noto-fonts-cjk --noconfirm
    systemctl enable sddm
    break
    ;;
        "XFCE")
    pacman -S xfce4 xfce4-whiskermenu-plugin xfce4-terminal xfce4-dev-tools lightdm lightdm-gtk-greeter gvfs thunar thunar-volman network-manager-applet noto-fonts noto-fonts-emoji noto-fonts-cjk --noconfirm
    systemctl enable lightdm
    break
    ;;    
        *)
    echo "Nieprawidlowa opcja"
    ;;
esac
done
